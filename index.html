<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>买条街APP下载</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .h5 {
            position: relative;
            width: 100%;
            height: 100vh;
            background: url('./img/bj.png') no-repeat;
            background-size: 100% 100%;
        }

        .posa {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .h5_log {
            width: 3.42rem;
            height: 3.42rem;
            top: 2.93rem;
        }

        .h5_title {
            width: 4.18rem;
            height: 0.53rem;
            top: 6.27rem;
        }

        #btn {
            bottom: 1.42rem;
            width: 3.75rem;
            height: 0.84rem;
            text-align: center;
            background: rgba(255, 70, 3, 0);
            border: 0.02rem solid rgba(255, 70, 3, 1);
            box-shadow: 0rem 0.05rem 0.1rem 0rem rgba(0, 0, 0, 0.11);
            border-radius: 0.42rem;
            line-height: 0.4rem;
        }

        #btn button {
            border: none;
            font-size: 0.42rem;
            width: 100%;
            /* font-family:PingFang SC; */
            font-weight: bold;
            color: rgba(255, 70, 3, 1);
            background-color: transparent;
        }
    </style>
    <script>
        (function () {
            function w() {
                /*document.documentElement.style.fontSize = document.documentElement.clientWidth / 7.5 + "px";*/
                var r = document.documentElement; //根元素html
                var a = r.clientWidth;
                //按照750的设计稿换算
                if (a > 750) {
                    a = 750;
                }
                rem = a / 7.5;
                r.style.fontSize = rem + "px";
            }
            var t;
            w();
            window.addEventListener("resize", function () {
                clearTimeout(t);
                t = setTimeout(w, 300);
            }, false);
        })();
    </script>
</head>

<body>
    <div class="h5">
        <img class="h5_log posa" src="./img/logo.png" alt="">
        <img class="h5_title posa" src="./img/zb.png" alt="">
        <div id="btn" class="posa">
            <a onclick="submitFn()" href="javascript:;"><button>立即下载APP</button></a>
        </div>
    </div>
</body>
<script>
    
//打开（下载）App
// function openApp(){
// 	var ua = window.navigator.userAgent.toLowerCase();
// 	//微信
//     if(ua.match(/MicroMessenger/i) == 'micromessenger'){
//     	// window.location.href='com.baidu.tieba://';
//         alert('点击右上角选择【在浏览器中】打开下载~~');
//         return;

//     }else{//非微信浏览器
//     	if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
//     	    window.location = "RenWaiRenApp.Merchant.AppStore";
//     	    var loadDateTime = new Date();
//     	    window.setTimeout(function() {
//     	    	var timeOutDateTime = new Date();
//     	    	if (timeOutDateTime - loadDateTime < 5000) {
//     	    		window.location = "https://apps.apple.com/cn/app/%E4%B9%B0%E6%9D%A1%E8%A1%97%E5%95%86%E5%AE%B6%E7%89%88/id1484441009";//ios下载地址
//     	    	} else {
//     	            window.close();
//     	    	}
//     	    },2000);
//     	  }else if (navigator.userAgent.match(/android/i)) {
//     	    var state = null;

//     	    try {
//     	    	window.location = 'weixin://';
//     	    	setTimeout(function(){
//     				window.location= ""; //android下载地址
 
//     			},500);
//     	    } catch(e) {}
// 	    }
//     }
// }

function submitFn(){
    //判断浏览器
    var u = navigator.userAgent;
    if(/MicroMessenger/gi.test(u)) {
       // 引导用户在浏览器中打开
        // alert('请在浏览器中打开');
        alert('点击右上角选择【在浏览器中】打开下载~~');
        return;
    }
    var d = new Date();
    var t0 = d.getTime();
    if(u.indexOf('Android') > -1 || u.indexOf('Linux') > -1){
        //Android
        if(openApp('en://startapp')){
         openApp('en://startapp');
        }else{
            //由于打开需要1～2秒，利用这个时间差来处理－－打开app后，返回h5页面会出现页面变成app下载页面，影响用户体验
            var delay = setInterval(function(){
                 var d = new Date();
                 var t1 = d.getTime();
                 if( t1-t0<3000 && t1-t0>2000){
                    alert('请下载APP');
                     window.location.href = "app下载地址";
                 }
                 if(t1-t0>=3000){
                      clearInterval(delay);
                 }
            },1000);
        }
    }else if(u.indexOf('iPhone') > -1){
        //IOS
        if(openApp('com.baidu.tieba:')){  
            openApp('com.baidu.tieba:');
        }else{
            var delay = setInterval(function(){
                var d = new Date();
                var t1 = d.getTime();
                if( t1-t0<3000 && t1-t0>2000){
                    // alert('请下载APP');
                    window.location.href = "https://apps.apple.com/cn/app/%E4%B9%B0%E6%9D%A1%E8%A1%97%E5%95%86%E5%AE%B6%E7%89%88/id1484441009";
                }
                if(t1-t0>=3000){
                    clearInterval(delay);
                }
            },1000);
        }
    }    
}

function openApp(src) {
// 通过iframe的方式试图打开APP，如果能正常打开，会直接切换到APP，并自动阻止a标签的默认行为
// 否则打开a标签的href链接
     var ifr = document.createElement('a');
     ifr.src = src;
     ifr.style.display = 'none';
     document.body.appendChild(ifr);
     window.setTimeout(function(){
          document.body.removeChild(ifr);
     },2000);
    //  var ifr = document.createElement('iframe');
    //  ifr.src = src;
    //  ifr.style.display = 'none';
    //  document.body.appendChild(ifr);
    //  window.setTimeout(function(){
    //       document.body.removeChild(ifr);
    //  },2000);
}
</script>

</html>